
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../../deploy/upgrade/migrate_v1_v2/">
      
      
        <link rel="next" href="../spec/">
      
      
      <link rel="icon" href="../../../assets/images/aws_load_balancer_icon.svg">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.31">
    
    
      
        <title>Annotations - AWS Load Balancer Controller</title>
      
    
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    <link rel="stylesheet" href="../../../assets/stylesheets/version-select.css">

    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ingress-annotations" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      <header class="md-header" data-md-component="header">
    <nav
      class="md-header__inner md-grid"
      aria-label="header.title"
    >
  
      <!-- Link to home -->
      <a
        href="../../.."
        title="AWS Load Balancer Controller"
        class="md-header__button md-logo"
        aria-label="AWS Load Balancer Controller"
        data-md-component="logo"
      >
        
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

      </a>
  
      <!-- Button to open drawer -->
      <label class="md-header__button md-icon" for="__drawer">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
      </label>
  
      <!-- Header title -->
      <div class="md-header__title" data-md-component="header-title">
        <div class="md-header__ellipsis">
          <div class="md-header__topic">
            <span class="md-ellipsis">
              AWS Load Balancer Controller
            </span>
          </div>
          <div class="md-header__topic" data-md-component="header-topic">
            <span class="md-ellipsis">
              
                Annotations
              
            </span>
          </div>
        </div>
      </div>
  
      <!-- Color palette -->
      

      <div id="version-select" class="mdc-select" data-base-url="../../..">
    <div class="mdc-select__anchor" role="button">
        <span class="mdc-select__ripple"></span>
        <span class="mdc-select__selected-text-container">
            <span class="mdc-select__selected-text"></span>
        </span>
        <span class="mdc-select__dropdown-icon">
            <svg class="mdc-select__dropdown-icon-graphic" viewBox="7 10 10 5" focusable="false">
                <polygon class="mdc-select__dropdown-icon-inactive" stroke="none" fill-rule="evenodd"
                    points="7 10 12 15 17 10">
                </polygon>
                <polygon class="mdc-select__dropdown-icon-active" stroke="none" fill-rule="evenodd"
                    points="7 15 12 10 17 15">
                </polygon>
            </svg>
        </span>
    </div>

    <div class="mdc-select__menu mdc-menu mdc-menu-surface mdc-menu-surface--fullwidth">
        <ul class="mdc-list" role="listbox">
        </ul>
    </div>
</div>
      <!-- Site language selector -->
      
  
      <!-- Button to open search modal -->
      
  
      <!-- Repository information -->
      
        <div class="md-header__source">
          <a href="https://github.com/kubernetes-sigs/aws-load-balancer-controller" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    kubernetes-sigs/aws-load-balancer-controller
  </div>
</a>
        </div>
      
    </nav>
  </header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../.." class="md-tabs__link">
          
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../deploy/installation/" class="md-tabs__link">
          
  
  Deployment

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  Guide

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../examples/echo_server/" class="md-tabs__link">
          
  
  Examples

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="AWS Load Balancer Controller" class="md-nav__button md-logo" aria-label="AWS Load Balancer Controller" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    AWS Load Balancer Controller
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/kubernetes-sigs/aws-load-balancer-controller" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    kubernetes-sigs/aws-load-balancer-controller
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Home
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../how-it-works/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How it works
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Deployment
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Deployment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../deploy/installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../deploy/configurations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configurations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../deploy/subnet_discovery/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Subnet Discovery
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../deploy/security_groups/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Security Group Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../deploy/pod_readiness_gate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pod Readiness Gate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../deploy/scaling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scaling your LBC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Upgrade
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            Upgrade
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../deploy/upgrade/migrate_v1_v2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Migrate v1 to v2
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Ingress
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Ingress
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Annotations
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Annotations
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#annotations" class="md-nav__link">
    <span class="md-ellipsis">
      Annotations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ingressgroup" class="md-nav__link">
    <span class="md-ellipsis">
      IngressGroup
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#traffic-listening" class="md-nav__link">
    <span class="md-ellipsis">
      Traffic Listening
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#traffic-routing" class="md-nav__link">
    <span class="md-ellipsis">
      Traffic Routing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access-control" class="md-nav__link">
    <span class="md-ellipsis">
      Access control
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#token-validation" class="md-nav__link">
    <span class="md-ellipsis">
      Token Validation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#health-check" class="md-nav__link">
    <span class="md-ellipsis">
      Health Check
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tls" class="md-nav__link">
    <span class="md-ellipsis">
      TLS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Custom attributes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resource-tags" class="md-nav__link">
    <span class="md-ellipsis">
      Resource Tags
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#capacity-unit-reservation" class="md-nav__link">
    <span class="md-ellipsis">
      Capacity Unit Reservation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#addons" class="md-nav__link">
    <span class="md-ellipsis">
      Addons
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enable-frontend-nlb" class="md-nav__link">
    <span class="md-ellipsis">
      Enable frontend NLB
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Specification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ingress_class/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IngressClass
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cert_discovery/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Certificate Discovery
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Service
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Service
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../service/nlb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network Load Balancer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../service/annotations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Annotations
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    TargetGroupBinding
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            TargetGroupBinding
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../targetgroupbinding/targetgroupbinding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TargetGroupBinding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../targetgroupbinding/spec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Specification
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Gateway API (New)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Gateway API (New)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gateway/gateway/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gateway/l4gateway/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    L4 Routing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gateway/l7gateway/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    L7 Routing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4_4" id="__nav_3_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Customizations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_4">
            <span class="md-nav__icon md-icon"></span>
            Customizations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gateway/customization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How customizations works
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gateway/loadbalancerconfig/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LoadBalancerConfiguration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gateway/targetgroupconfig/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TargetGroupConfiguration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gateway/listenerruleconfig/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ListenerRuleConfiguration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gateway/spec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Specification
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tasks
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            Tasks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tasks/cognito_authentication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cognito Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tasks/ssl_redirect/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SSL Redirect
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tasks/url_rewrite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    URL Rewrite
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Use Cases
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            Use Cases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../use_cases/nlb_tls_termination/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NLB TLS Termination
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../use_cases/self_managed_lb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Externally Managed Load Balancer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../use_cases/frontend_sg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Frontend Security Groups
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../use_cases/blue_green/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blue/Green
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../use_cases/multi_cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MultiCluster Target Groups
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../use_cases/quic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QUIC
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Metrics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            Metrics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../metrics/prometheus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prometheus
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/echo_server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EchoServer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/grpc_server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gRPCServer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/external_dns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setup External DNS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/secrets_access/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RBAC to access OIDC Secret
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#annotations" class="md-nav__link">
    <span class="md-ellipsis">
      Annotations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ingressgroup" class="md-nav__link">
    <span class="md-ellipsis">
      IngressGroup
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#traffic-listening" class="md-nav__link">
    <span class="md-ellipsis">
      Traffic Listening
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#traffic-routing" class="md-nav__link">
    <span class="md-ellipsis">
      Traffic Routing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access-control" class="md-nav__link">
    <span class="md-ellipsis">
      Access control
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#token-validation" class="md-nav__link">
    <span class="md-ellipsis">
      Token Validation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#health-check" class="md-nav__link">
    <span class="md-ellipsis">
      Health Check
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tls" class="md-nav__link">
    <span class="md-ellipsis">
      TLS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Custom attributes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resource-tags" class="md-nav__link">
    <span class="md-ellipsis">
      Resource Tags
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#capacity-unit-reservation" class="md-nav__link">
    <span class="md-ellipsis">
      Capacity Unit Reservation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#addons" class="md-nav__link">
    <span class="md-ellipsis">
      Addons
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enable-frontend-nlb" class="md-nav__link">
    <span class="md-ellipsis">
      Enable frontend NLB
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="ingress-annotations">Ingress annotations<a class="headerlink" href="#ingress-annotations" title="Permanent link">&para;</a></h1>
<p>You can add annotations to kubernetes Ingress and Service objects to customize their behavior.</p>
<div class="admonition note">
<ul>
<li>Annotation keys and values can only be strings. Advanced format should be encoded as below:<ul>
<li>boolean: 'true'</li>
<li>integer: '42'</li>
<li>stringList: s1,s2,s3</li>
<li>stringMap: k1=v1,k2=v2</li>
<li>json: 'jsonContent'</li>
</ul>
</li>
<li>Annotations applied to Service have higher priority over annotations applied to Ingress. <code>Location</code> column below indicates where that annotation can be applied to.</li>
<li>Annotations that configures LoadBalancer / Listener behaviors have different merge behavior when IngressGroup feature is been used. <code>MergeBehavior</code> column below indicates how such annotation will be merged.<ul>
<li>Exclusive: such annotation should only be specified on a single Ingress within IngressGroup or specified with same value across all Ingresses within IngressGroup.</li>
<li>Merge: such annotation can be specified on all Ingresses within IngressGroup, and will be merged together.</li>
</ul>
</li>
</ul>
</div>
<h2 id="annotations">Annotations<a class="headerlink" href="#annotations" title="Permanent link">&para;</a></h2>
<div class="admonition question">
<p class="admonition-title">EKS Auto Mode users</p>
<p>If you are using EKS Auto Mode, please see the
<a href="https://docs.aws.amazon.com/eks/latest/userguide/auto-configure-alb.html#_considerations">EKS Auto Mode documentation</a>
for key differences between the load balancing capability of EKS Auto Mode and the open source load balancer controller.</p>
</div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Default</th>
<th>Location</th>
<th>MergeBehavior</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#load-balancer-name">alb.ingress.kubernetes.io/load-balancer-name</a></td>
<td>string</td>
<td>N/A</td>
<td>Ingress</td>
<td>Exclusive</td>
</tr>
<tr>
<td><a href="#group.name">alb.ingress.kubernetes.io/group.name</a></td>
<td>string</td>
<td>N/A</td>
<td>Ingress</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#group.order">alb.ingress.kubernetes.io/group.order</a></td>
<td>integer</td>
<td>0</td>
<td>Ingress</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#tags">alb.ingress.kubernetes.io/tags</a></td>
<td>stringMap</td>
<td>N/A</td>
<td>Ingress,Service</td>
<td>Merge</td>
</tr>
<tr>
<td><a href="#ip-address-type">alb.ingress.kubernetes.io/ip-address-type</a></td>
<td>ipv4 | dualstack |  dualstack-without-public-ipv4</td>
<td>ipv4</td>
<td>Ingress</td>
<td>Exclusive</td>
</tr>
<tr>
<td><a href="#scheme">alb.ingress.kubernetes.io/scheme</a></td>
<td>internal | internet-facing</td>
<td>internal</td>
<td>Ingress</td>
<td>Exclusive</td>
</tr>
<tr>
<td><a href="#subnets">alb.ingress.kubernetes.io/subnets</a></td>
<td>stringList</td>
<td>N/A</td>
<td>Ingress</td>
<td>Exclusive</td>
</tr>
<tr>
<td><a href="#security-groups">alb.ingress.kubernetes.io/security-groups</a></td>
<td>stringList</td>
<td>N/A</td>
<td>Ingress</td>
<td>Exclusive</td>
</tr>
<tr>
<td><a href="#manage-backend-security-group-rules">alb.ingress.kubernetes.io/manage-backend-security-group-rules</a></td>
<td>boolean</td>
<td>N/A</td>
<td>Ingress</td>
<td>Exclusive</td>
</tr>
<tr>
<td><a href="#customer-owned-ipv4-pool">alb.ingress.kubernetes.io/customer-owned-ipv4-pool</a></td>
<td>string</td>
<td>N/A</td>
<td>Ingress</td>
<td>Exclusive</td>
</tr>
<tr>
<td><a href="#load-balancer-attributes">alb.ingress.kubernetes.io/load-balancer-attributes</a></td>
<td>stringMap</td>
<td>N/A</td>
<td>Ingress</td>
<td>Exclusive</td>
</tr>
<tr>
<td><a href="#wafv2-acl-arn">alb.ingress.kubernetes.io/wafv2-acl-arn</a></td>
<td>string</td>
<td>N/A</td>
<td>Ingress</td>
<td>Exclusive</td>
</tr>
<tr>
<td><a href="#waf-acl-id">alb.ingress.kubernetes.io/waf-acl-id</a></td>
<td>string</td>
<td>N/A</td>
<td>Ingress</td>
<td>Exclusive</td>
</tr>
<tr>
<td><a href="#shield-advanced-protection">alb.ingress.kubernetes.io/shield-advanced-protection</a></td>
<td>boolean</td>
<td>N/A</td>
<td>Ingress</td>
<td>Exclusive</td>
</tr>
<tr>
<td><a href="#listen-ports">alb.ingress.kubernetes.io/listen-ports</a></td>
<td>json</td>
<td>'[{"HTTP": 80}]' | '[{"HTTPS": 443}]'</td>
<td>Ingress</td>
<td>Merge</td>
</tr>
<tr>
<td><a href="#ssl-redirect">alb.ingress.kubernetes.io/ssl-redirect</a></td>
<td>integer</td>
<td>N/A</td>
<td>Ingress</td>
<td>Exclusive</td>
</tr>
<tr>
<td><a href="#inbound-cidrs">alb.ingress.kubernetes.io/inbound-cidrs</a></td>
<td>stringList</td>
<td>0.0.0.0/0, ::/0</td>
<td>Ingress</td>
<td>Exclusive</td>
</tr>
<tr>
<td><a href="#security-group-prefix-lists">alb.ingress.kubernetes.io/security-group-prefix-lists</a></td>
<td>stringList</td>
<td>pl-00000000, pl-1111111</td>
<td>Ingress</td>
<td>Exclusive</td>
</tr>
<tr>
<td><a href="#certificate-arn">alb.ingress.kubernetes.io/certificate-arn</a></td>
<td>stringList</td>
<td>N/A</td>
<td>Ingress</td>
<td>Merge</td>
</tr>
<tr>
<td><a href="#ssl-policy">alb.ingress.kubernetes.io/ssl-policy</a></td>
<td>string</td>
<td>ELBSecurityPolicy-2016-08</td>
<td>Ingress</td>
<td>Exclusive</td>
</tr>
<tr>
<td><a href="#target-type">alb.ingress.kubernetes.io/target-type</a></td>
<td>instance | ip</td>
<td>instance</td>
<td>Ingress,Service</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#backend-protocol">alb.ingress.kubernetes.io/backend-protocol</a></td>
<td>HTTP | HTTPS</td>
<td>HTTP</td>
<td>Ingress,Service</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#backend-protocol-version">alb.ingress.kubernetes.io/backend-protocol-version</a></td>
<td>string</td>
<td>HTTP1</td>
<td>Ingress,Service</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#target-group-attributes">alb.ingress.kubernetes.io/target-group-attributes</a></td>
<td>stringMap</td>
<td>N/A</td>
<td>Ingress,Service</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#healthcheck-port">alb.ingress.kubernetes.io/healthcheck-port</a></td>
<td>integer | traffic-port</td>
<td>traffic-port</td>
<td>Ingress,Service</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#healthcheck-protocol">alb.ingress.kubernetes.io/healthcheck-protocol</a></td>
<td>HTTP | HTTPS</td>
<td>HTTP</td>
<td>Ingress,Service</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#healthcheck-path">alb.ingress.kubernetes.io/healthcheck-path</a></td>
<td>string</td>
<td>/ | /AWS.ALB/healthcheck</td>
<td>Ingress,Service</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#healthcheck-interval-seconds">alb.ingress.kubernetes.io/healthcheck-interval-seconds</a></td>
<td>integer</td>
<td>'15'</td>
<td>Ingress,Service</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#healthcheck-timeout-seconds">alb.ingress.kubernetes.io/healthcheck-timeout-seconds</a></td>
<td>integer</td>
<td>'5'</td>
<td>Ingress,Service</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#healthy-threshold-count">alb.ingress.kubernetes.io/healthy-threshold-count</a></td>
<td>integer</td>
<td>'2'</td>
<td>Ingress,Service</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#unhealthy-threshold-count">alb.ingress.kubernetes.io/unhealthy-threshold-count</a></td>
<td>integer</td>
<td>'2'</td>
<td>Ingress,Service</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#success-codes">alb.ingress.kubernetes.io/success-codes</a></td>
<td>string</td>
<td>'200' | '12'</td>
<td>Ingress,Service</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#auth-type">alb.ingress.kubernetes.io/auth-type</a></td>
<td>none|oidc|cognito</td>
<td>none</td>
<td>Ingress,Service</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#auth-idp-cognito">alb.ingress.kubernetes.io/auth-idp-cognito</a></td>
<td>json</td>
<td>N/A</td>
<td>Ingress,Service</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#auth-idp-oidc">alb.ingress.kubernetes.io/auth-idp-oidc</a></td>
<td>json</td>
<td>N/A</td>
<td>Ingress,Service</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#auth-on-unauthenticated-request">alb.ingress.kubernetes.io/auth-on-unauthenticated-request</a></td>
<td>authenticate|allow|deny</td>
<td>authenticate</td>
<td>Ingress,Service</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#auth-scope">alb.ingress.kubernetes.io/auth-scope</a></td>
<td>string</td>
<td>openid</td>
<td>Ingress,Service</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#auth-session-cookie">alb.ingress.kubernetes.io/auth-session-cookie</a></td>
<td>string</td>
<td>AWSELBAuthSessionCookie</td>
<td>Ingress,Service</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#auth-session-timeout">alb.ingress.kubernetes.io/auth-session-timeout</a></td>
<td>integer</td>
<td>'604800'</td>
<td>Ingress,Service</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#jwt-validation">alb.ingress.kubernetes.io/jwt-validation</a></td>
<td>json</td>
<td>N/A</td>
<td>Ingress</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#actions">alb.ingress.kubernetes.io/actions.${action-name}</a></td>
<td>json</td>
<td>N/A</td>
<td>Ingress</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#transforms">alb.ingress.kubernetes.io/transforms.${transforms-name}</a></td>
<td>json</td>
<td>N/A</td>
<td>Ingress</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#conditions">alb.ingress.kubernetes.io/conditions.${conditions-name}</a></td>
<td>json</td>
<td>N/A</td>
<td>Ingress</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#use-regex-path-match">alb.ingress.kubernetes.io/use-regex-path-match</a></td>
<td>boolean</td>
<td>N/A</td>
<td>Ingress</td>
<td>false</td>
</tr>
<tr>
<td><a href="#target-node-labels">alb.ingress.kubernetes.io/target-node-labels</a></td>
<td>stringMap</td>
<td>N/A</td>
<td>Ingress,Service</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#mutual-authentication">alb.ingress.kubernetes.io/mutual-authentication</a></td>
<td>json</td>
<td>N/A</td>
<td>Ingress</td>
<td>Exclusive</td>
</tr>
<tr>
<td><a href="#multi-cluster-target-group">alb.ingress.kubernetes.io/multi-cluster-target-group</a></td>
<td>boolean</td>
<td>N/A</td>
<td>Ingress, Service</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#listener-attributes">alb.ingress.kubernetes.io/listener-attributes.${Protocol}-${Port}</a></td>
<td>stringMap</td>
<td>N/A</td>
<td>Ingress</td>
<td>Merge</td>
</tr>
<tr>
<td><a href="#load-balancer-capacity-reservation">alb.ingress.kubernetes.io/minimum-load-balancer-capacity</a></td>
<td>stringMap</td>
<td>N/A</td>
<td>Ingress</td>
<td>Exclusive</td>
</tr>
<tr>
<td><a href="#ipam-ipv4-pool-id">alb.ingress.kubernetes.io/ipam-ipv4-pool-id</a></td>
<td>string</td>
<td>N/A</td>
<td>Ingress</td>
<td>Exclusive</td>
</tr>
<tr>
<td><a href="#enable-frontend-nlb">alb.ingress.kubernetes.io/enable-frontend-nlb</a></td>
<td>boolean</td>
<td>false</td>
<td>Ingress</td>
<td>Exclusive</td>
</tr>
<tr>
<td><a href="#frontend-nlb-scheme">alb.ingress.kubernetes.io/frontend-nlb-scheme</a></td>
<td>internal | internet-facing</td>
<td>internal</td>
<td>Ingress</td>
<td>Exclusive</td>
</tr>
<tr>
<td><a href="#frontend-nlb-subnets">alb.ingress.kubernetes.io/frontend-nlb-subnets</a></td>
<td>stringList</td>
<td>N/A</td>
<td>Ingress</td>
<td>Exclusive</td>
</tr>
<tr>
<td><a href="#frontend-nlb-security-groups">alb.ingress.kubernetes.io/frontend-nlb-security-groups</a></td>
<td>stringList</td>
<td>N/A</td>
<td>Ingress</td>
<td>Exclusive</td>
</tr>
<tr>
<td><a href="#frontend-nlb-listener-port-mapping">alb.ingress.kubernetes.io/frontend-nlb-listener-port-mapping</a></td>
<td>stringMap</td>
<td>N/A</td>
<td>Ingress</td>
<td>Merge</td>
</tr>
<tr>
<td><a href="#frontend-nlb-healthcheck-port">alb.ingress.kubernetes.io/frontend-nlb-healthcheck-port</a></td>
<td>integer | traffic-port</td>
<td>traffic-port</td>
<td>Ingress</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#frontend-nlb-healthcheck-protocol">alb.ingress.kubernetes.io/frontend-nlb-healthcheck-protocol</a></td>
<td>HTTP | HTTPS</td>
<td>HTTP</td>
<td>Ingress</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#frontend-nlb-healthcheck-path">alb.ingress.kubernetes.io/frontend-nlb-healthcheck-path</a></td>
<td>string</td>
<td>/</td>
<td>Ingress</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#frontend-nlb-healthcheck-interval-seconds">alb.ingress.kubernetes.io/frontend-nlb-healthcheck-interval-seconds</a></td>
<td>integer</td>
<td>15</td>
<td>Ingress</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#frontend-nlb-healthcheck-timeout-seconds">alb.ingress.kubernetes.io/frontend-nlb-healthcheck-timeout-seconds</a></td>
<td>integer</td>
<td>5</td>
<td>Ingress</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#frontend-nlb-healthcheck-healthy-threshold-count">alb.ingress.kubernetes.io/frontend-nlb-healthcheck-healthy-threshold-count</a></td>
<td>integer</td>
<td>3</td>
<td>Ingress</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#frontend-nlb-healthcheck-unhealthy-threshold-count">alb.ingress.kubernetes.io/frontend-nlb-healthcheck-unhealthy-threshold-count</a></td>
<td>integer</td>
<td>3</td>
<td>Ingress</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#frontend-nlb-healthcheck-success-codes">alb.ingress.kubernetes.io/frontend-nlb-healthcheck-success-codes</a></td>
<td>string</td>
<td>200</td>
<td>Ingress</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="#frontend-nlb-tags">alb.ingress.kubernetes.io/frontend-nlb-tags</a></td>
<td>stringMap</td>
<td>N/A</td>
<td>Ingress</td>
<td>Exclusive</td>
</tr>
<tr>
<td><a href="#frontend-nlb-eip-allocations">alb.ingress.kubernetes.io/frontend-nlb-eip-allocations</a></td>
<td>stringList</td>
<td>200</td>
<td>Ingress</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h2 id="ingressgroup">IngressGroup<a class="headerlink" href="#ingressgroup" title="Permanent link">&para;</a></h2>
<p>IngressGroup feature enables you to group multiple Ingress resources together.
The controller will automatically merge Ingress rules for all Ingresses within IngressGroup and support them with a single ALB.
In addition, most annotations defined on an Ingress only apply to the paths defined by that Ingress.</p>
<p>By default, Ingresses don't belong to any IngressGroup, and we treat it as a "implicit IngressGroup" consisting of the Ingress itself.</p>
<ul>
<li>
<p><a name="group.name"><code>alb.ingress.kubernetes.io/group.name</code></a> specifies the group name that this Ingress belongs to.</p>
<div class="admonition note">
<ul>
<li>Ingresses with same <code>group.name</code> annotation will form an "explicit IngressGroup".</li>
<li>groupName must consist of lower case alphanumeric characters, <code>-</code> or <code>.</code>, and must start and end with an alphanumeric character.</li>
<li>groupName must be no more than 63 character.</li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Security Risk</p>
<p>IngressGroup feature should only be used when all Kubernetes users with RBAC permission to create/modify Ingress resources are within trust boundary.</p>
<p>If you turn your Ingress to belong a "explicit IngressGroup" by adding <code>group.name</code> annotation,
other Kubernetes users may create/modify their Ingresses to belong to the same IngressGroup, and can thus add more rules or overwrite existing rules with higher priority to the ALB for your Ingress.</p>
<p>We'll add more fine-grained access-control in future versions.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Rename behavior</p>
<p>The ALB for an IngressGroup is found by searching for an AWS tag <code>ingress.k8s.aws/stack</code> tag with the name of the IngressGroup as its value. For an implicit IngressGroup, the value is <code>namespace/ingressname</code>.</p>
<p>When the groupName of an IngressGroup for an Ingress is changed, the Ingress will be moved to a new IngressGroup and be supported by the ALB for the new IngressGroup. If the ALB for the new IngressGroup doesn't exist, a new ALB will be created.</p>
<p>If an IngressGroup no longer contains any Ingresses, the ALB for that IngressGroup will be deleted and any deletion protection of that ALB will be ignored.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/group.name: my-team.awesome-group
</code></pre></div>
</div>
</li>
<li>
<p><a name="group.order"><code>alb.ingress.kubernetes.io/group.order</code></a> specifies the order across all Ingresses within IngressGroup.</p>
<div class="admonition note">
<ul>
<li>You can explicitly denote the order using a number between -1000 and 1000</li>
<li>The smaller the order, the rule will be evaluated first. All Ingresses without an explicit order setting get order value as 0</li>
<li>Rules with the same order are sorted lexicographically by the Ingresss namespace/name.</li>
</ul>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/group.order: &#39;10&#39;
</code></pre></div>
</div>
</li>
</ul>
<h2 id="traffic-listening">Traffic Listening<a class="headerlink" href="#traffic-listening" title="Permanent link">&para;</a></h2>
<p>Traffic Listening can be controlled with the following annotations:</p>
<ul>
<li>
<p><a name="listen-ports"><code>alb.ingress.kubernetes.io/listen-ports</code></a> specifies the ports that ALB listens on.</p>
<div class="admonition note">
<p class="admonition-title">Merge Behavior</p>
<p><code>listen-ports</code> is merged across all Ingresses in IngressGroup.</p>
<ul>
<li>You can define different listen-ports per Ingress, Ingress rules will only impact the ports defined for that Ingress.</li>
<li>If same listen-port is defined by multiple Ingress within IngressGroup, Ingress rules will be merged with respect to their group order within IngressGroup.</li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Default</p>
<ul>
<li>defaults to <code>'[{"HTTP": 80}]'</code> or <code>'[{"HTTPS": 443}]'</code> depending on whether <code>certificate-arn</code> is specified.</li>
</ul>
</div>
<div class="admonition warning">
<p>You may not have duplicate load balancer ports defined.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/listen-ports: &#39;[{&quot;HTTP&quot;: 80}, {&quot;HTTPS&quot;: 443}, {&quot;HTTP&quot;: 8080}, {&quot;HTTPS&quot;: 8443}]&#39;
</code></pre></div>
</div>
</li>
<li>
<p><a name="ssl-redirect"><code>alb.ingress.kubernetes.io/ssl-redirect</code></a> enables SSLRedirect and specifies the SSL port that redirects to.</p>
<div class="admonition note">
<p class="admonition-title">Merge Behavior</p>
<p><code>ssl-redirect</code> is exclusive across all Ingresses in IngressGroup.</p>
<ul>
<li>Once defined on a single Ingress, it impacts every Ingress within IngressGroup.</li>
</ul>
</div>
<div class="admonition note">
<ul>
<li>Once enabled SSLRedirect, every HTTP listener will be configured with a default action which redirects to HTTPS, other rules will be ignored.</li>
<li>The SSL port that redirects to must exists on LoadBalancer. See <a href="#listen-ports">alb.ingress.kubernetes.io/listen-ports</a> for the listen ports configuration.</li>
</ul>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/ssl-redirect: &#39;443&#39;
</code></pre></div>
</div>
</li>
<li>
<p><a name="ip-address-type"><code>alb.ingress.kubernetes.io/ip-address-type</code></a> specifies the <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/application-load-balancers.html#ip-address-type">IP address type</a> of ALB.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/ip-address-type: ipv4
</code></pre></div>
</div>
</li>
<li>
<p><a name="customer-owned-ipv4-pool"><code>alb.ingress.kubernetes.io/customer-owned-ipv4-pool</code></a> specifies the customer-owned IPv4 address pool for ALB on Outpost.</p>
<div class="admonition warning">
<p>This annotation should be treated as immutable. To remove or change coIPv4Pool, you need to recreate Ingress.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/customer-owned-ipv4-pool: ipv4pool-coip-xxxxxxxx
</code></pre></div>
</div>
</li>
</ul>
<h2 id="traffic-routing">Traffic Routing<a class="headerlink" href="#traffic-routing" title="Permanent link">&para;</a></h2>
<p>Traffic Routing can be controlled with following annotations:</p>
<ul>
<li>
<p><a name="load-balancer-name"><code>alb.ingress.kubernetes.io/load-balancer-name</code></a> specifies the custom name to use for the load balancer. Name longer than 32 characters will be treated as an error.</p>
<div class="admonition note">
<p class="admonition-title">Merge Behavior</p>
<p><code>name</code> is exclusive across all Ingresses in an IngressGroup.</p>
<ul>
<li>Once defined on a single Ingress, it impacts every Ingress within the IngressGroup.</li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Annotation Behavior</p>
<ul>
<li>This annotation <strong>takes effect only during the creation</strong> of the Ingress. If the Ingress already exists, the change will not be applied until the Ingress is <strong>deleted and recreated</strong>.</li>
</ul>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/load-balancer-name: custom-name
</code></pre></div>
</div>
</li>
<li>
<p><a name="target-type"><code>alb.ingress.kubernetes.io/target-type</code></a> specifies how to route traffic to pods. You can choose between <code>instance</code> and <code>ip</code>:</p>
<ul>
<li>
<p><code>instance</code> mode will route traffic to all ec2 instances within cluster on <a href="https://kubernetes.io/docs/concepts/services-networking/service/#type-nodeport">NodePort</a> opened for your service.</p>
<div class="admonition note">
<p>service must be of type "NodePort" or "LoadBalancer" to use <code>instance</code> mode</p>
</div>
</li>
<li>
<p><code>ip</code> mode will route traffic directly to the pod IP.</p>
<div class="admonition note">
<p>network plugin must use secondary IP addresses on <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-eni.html">ENI</a> for pod IP to use <code>ip</code> mode. e.g.</p>
<ul>
<li><a href="https://github.com/aws/amazon-vpc-cni-k8s">amazon-vpc-cni-k8s</a></li>
</ul>
</div>
<div class="admonition note">
<p><code>ip</code> mode is required for sticky sessions to work with Application Load Balancers. The Service type does not matter, when using <code>ip</code> mode.</p>
</div>
</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/target-type: instance
</code></pre></div>
</div>
</li>
<li>
<p><a name="target-node-labels"><code>alb.ingress.kubernetes.io/target-node-labels</code></a> specifies which nodes to include in the target group registration for <code>instance</code> target type.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/target-node-labels: label1=value1, label2=value2
</code></pre></div>
</div>
</li>
<li>
<p><a name="backend-protocol"><code>alb.ingress.kubernetes.io/backend-protocol</code></a> specifies the protocol used when route traffic to pods.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/backend-protocol: HTTPS
</code></pre></div>
</div>
</li>
<li>
<p><a name="backend-protocol-version"><code>alb.ingress.kubernetes.io/backend-protocol-version</code></a> specifies the application protocol used to route traffic to pods. Only valid when HTTP or HTTPS is used as the backend protocol.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>HTTP2
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/backend-protocol-version: HTTP2
</code></pre></div></li>
<li>GRPC
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/backend-protocol-version: GRPC
</code></pre></div></li>
</ul>
</div>
</li>
<li>
<p><a name="subnets"><code>alb.ingress.kubernetes.io/subnets</code></a> specifies the <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-regions-availability-zones.html">Availability Zone</a>s that the ALB will route traffic to. See <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-subnets.html">Load Balancer subnets</a> for more details.</p>
<div class="admonition note">
<p>You must specify at least two subnets in different AZs unless utilizing the outpost locale, in which case a single subnet suffices. Either subnetID or subnetName(Name tag on subnets) can be used.</p>
</div>
<div class="admonition note">
<p>You must not mix subnets from different locales: availability-zone, local-zone, wavelength-zone, outpost.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can enable subnet auto discovery to avoid specifying this annotation on every Ingress. See <a href="../../../deploy/subnet_discovery/">Subnet Discovery</a> for instructions.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/subnets: subnet-xxxx, mySubnet
</code></pre></div>
</div>
</li>
<li>
<p><a name="ipam-ipv4-pool-id"><code>alb.ingress.kubernetes.io/ipam-ipv4-pool-id</code></a> Specifies the <a href="https://docs.aws.amazon.com/vpc/latest/ipam/tutorials-byoip-ipam-console-ipv4.html">IPv4 IPAM Pool ID</a> which will be used by your load balancer to assign IP addresses.</p>
</li>
</ul>
<p>!!!note ""
  The chosen IPAM pool is always the prioritized source when assigning public IPv4 addresses.
  If there are no more assignable IP addresses in the IPAM pool, AWS managed IPv4 addresses are assigned.</p>
<p>!!!tip
  To remove an IPAM pool associated to your ALB, remove the annotation from your ingress.</p>
<p>!!!example
  <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/ipam-ipv4-pool-id: ipam-pool-0f995c17c00375b48
</code></pre></div></p>
<ul>
<li>
<p><a name="actions"><code>alb.ingress.kubernetes.io/actions.${action-name}</code></a> Provides a method for configuring custom actions on a listener, such as Redirect Actions.</p>
<p>The <code>action-name</code> in the annotation must match the serviceName in the Ingress rules, and servicePort must be <code>use-annotation</code>.</p>
<div class="admonition note">
<p class="admonition-title">use TargetGroupARN/TargetGroupName in forward Action</p>
<p>TargetGroupARN/TargetGroupName can be used in forward action (both simplified schema and advanced schema), it must be a target group created outside of k8s, typically a targetGroup for a legacy application.</p>
</div>
<div class="admonition note">
<p class="admonition-title">use ServiceName/ServicePort in forward Action</p>
<p>ServiceName/ServicePort can be used in forward action (advanced schema only).</p>
</div>
<div class="admonition warning">
<p><a href="#authentication">Auth related annotations</a> on a Service object will only be respected if a single TargetGroup is used.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>response-503: return fixed 503 response</li>
<li>redirect-to-eks: redirect to an external url</li>
<li>forward-single-tg: forward to a single targetGroup [<strong>simplified schema</strong>]</li>
<li>forward-single-tg-by-name: forward to a single targetGroup identified by its name  [<strong>simplified schema</strong>]</li>
<li>forward-multiple-tg: forward to multiple targetGroups with different weights and stickiness config [<strong>advanced schema</strong>]</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ingress</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">alb.ingress.kubernetes.io/scheme</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">internet-facing</span>
<span class="w">    </span><span class="nt">alb.ingress.kubernetes.io/actions.response-503</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">{&quot;type&quot;:&quot;fixed-response&quot;,&quot;fixedResponseConfig&quot;:{&quot;contentType&quot;:&quot;text/plain&quot;,&quot;statusCode&quot;:&quot;503&quot;,&quot;messageBody&quot;:&quot;503 error text&quot;}}</span>
<span class="w">    </span><span class="nt">alb.ingress.kubernetes.io/actions.redirect-to-eks</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">{&quot;type&quot;:&quot;redirect&quot;,&quot;redirectConfig&quot;:{&quot;host&quot;:&quot;aws.amazon.com&quot;,&quot;path&quot;:&quot;/eks/&quot;,&quot;port&quot;:&quot;443&quot;,&quot;protocol&quot;:&quot;HTTPS&quot;,&quot;query&quot;:&quot;k=v&quot;,&quot;statusCode&quot;:&quot;HTTP_302&quot;}}</span>
<span class="w">    </span><span class="nt">alb.ingress.kubernetes.io/actions.forward-single-tg</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">{&quot;type&quot;:&quot;forward&quot;,&quot;targetGroupARN&quot;: &quot;arn-of-your-target-group&quot;}</span>
<span class="w">    </span><span class="nt">alb.ingress.kubernetes.io/actions.forward-single-tg-by-name</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">{&quot;type&quot;:&quot;forward&quot;,&quot;targetGroupName&quot;: &quot;name-of-your-target-group&quot;}</span>
<span class="w">    </span><span class="nt">alb.ingress.kubernetes.io/actions.forward-multiple-tg</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">{&quot;type&quot;:&quot;forward&quot;,&quot;forwardConfig&quot;:{&quot;targetGroups&quot;:[{&quot;serviceName&quot;:&quot;service-1&quot;,&quot;servicePort&quot;:&quot;http&quot;,&quot;weight&quot;:20},{&quot;serviceName&quot;:&quot;service-2&quot;,&quot;servicePort&quot;:80,&quot;weight&quot;:20},{&quot;targetGroupARN&quot;:&quot;arn-of-your-non-k8s-target-group&quot;,&quot;weight&quot;:60},{&quot;targetGroupName&quot;:&quot;name-of-your-non-k8s-target-group&quot;,&quot;weight&quot;:80}],&quot;targetGroupStickinessConfig&quot;:{&quot;enabled&quot;:true,&quot;durationSeconds&quot;:200}}}</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ingressClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">alb</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">http</span><span class="p">:</span>
<span class="w">        </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/503</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Exact</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">response-503</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">use-annotation</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/eks</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Exact</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redirect-to-eks</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">use-annotation</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path1</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Exact</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">forward-single-tg</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">use-annotation</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path2</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Exact</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">forward-single-tg-by-name</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">use-annotation</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path3</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Exact</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">forward-multiple-tg</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">use-annotation</span>
</code></pre></div>
</div>
</li>
<li>
<p><a name="transforms"><code>alb.ingress.kubernetes.io/transforms.${transforms-name}</code></a> Provides a method for specifying transforms on Ingress spec.</p>
<p>The <code>transforms-name</code> in the annotation must match the serviceName in the Ingress rules.</p>
<div class="admonition example">
<p class="admonition-title">URL rewrite</p>
<p>Example transform to remove the leading <code>/api/</code> from request paths:</p>
<div class="highlight"><pre><span></span><code><span class="nt">alb.ingress.kubernetes.io/transforms.my-service</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">    </span><span class="no">[</span>
<span class="w">        </span><span class="no">{</span>
<span class="w">            </span><span class="no">&quot;type&quot;: &quot;url-rewrite&quot;,</span>
<span class="w">            </span><span class="no">&quot;urlRewriteConfig&quot;: {</span>
<span class="w">                </span><span class="no">&quot;rewrites&quot;: [</span>
<span class="w">                    </span><span class="no">{</span>
<span class="w">                        </span><span class="no">&quot;regex&quot;: &quot;^\\/api\\/(.+)$&quot;,</span>
<span class="w">                        </span><span class="no">&quot;replace&quot;: &quot;/$1&quot;</span>
<span class="w">                    </span><span class="no">}</span>
<span class="w">                </span><span class="no">]</span>
<span class="w">            </span><span class="no">}</span>
<span class="w">        </span><span class="no">}</span>
<span class="w">    </span><span class="no">]</span>
</code></pre></div>
</div>
<div class="admonition example">
<p class="admonition-title">Host header rewrite</p>
<p>Example transform to replace <code>example.com</code> with <code>example.org</code> from request host headers:</p>
<div class="highlight"><pre><span></span><code><span class="nt">alb.ingress.kubernetes.io/transforms.my-service</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">    </span><span class="no">[</span>
<span class="w">        </span><span class="no">{</span>
<span class="w">            </span><span class="no">&quot;type&quot;: &quot;host-header-rewrite&quot;,</span>
<span class="w">            </span><span class="no">&quot;hostHeaderRewriteConfig&quot;: {</span>
<span class="w">                </span><span class="no">&quot;rewrites&quot;: [</span>
<span class="w">                    </span><span class="no">{</span>
<span class="w">                        </span><span class="no">&quot;regex&quot;: &quot;^(.+)\\.example\\.com$&quot;,</span>
<span class="w">                        </span><span class="no">&quot;replace&quot;: &quot;$1.example.org&quot;</span>
<span class="w">                    </span><span class="no">}</span>
<span class="w">                </span><span class="no">]</span>
<span class="w">            </span><span class="no">}</span>
<span class="w">        </span><span class="no">}</span>
<span class="w">    </span><span class="no">]</span>
</code></pre></div>
</div>
</li>
<li>
<p><a name="conditions"><code>alb.ingress.kubernetes.io/conditions.${conditions-name}</code></a> Provides a method for specifying routing conditions <strong>in addition to original host/path condition on Ingress spec</strong>.</p>
<p>The <code>conditions-name</code> in the annotation must match the serviceName in the Ingress rules.
It can be a either real serviceName or an annotation based action name when servicePort is <code>use-annotation</code>.</p>
<p>Condition values can be specified using <em>either</em> <code>values</code> or <code>regexValues</code>:</p>
<ul>
<li>
<p><code>values</code>: Wildcard syntax, where <code>*</code> matches 0 or more characters, and <code>?</code> matches exactly 1 character.</p>
<p><code>values</code> is supported for all condition types: <code>host-header</code>, <code>http-header</code>, <code>http-request-method</code>, <code>path-pattern</code>, and <code>source-ip</code>.</p>
</li>
<li>
<p><code>regexValues</code>: Regex syntax.</p>
<p><code>regexValues</code> is supported for the following condition types: <code>host-header</code>, <code>http-header</code>, and <code>path-pattern</code>.</p>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">limitations</p>
<p>General ALB limitations applies:</p>
<ol>
<li>
<p>Each rule can optionally include up to one of each of the following conditions: host-header, http-request-method, path-pattern, and source-ip. Each rule can also optionally include one or more of each of the following conditions: http-header and query-string.</p>
</li>
<li>
<p>You can specify up to three match evaluations per condition.</p>
</li>
<li>
<p>You can specify up to five match evaluations per rule.</p>
</li>
</ol>
<p>Refer <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html#rule-condition-types">ALB documentation</a> for more details.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Examples using <code>values</code></p>
<ul>
<li>rule-path1:<ul>
<li>Host is www.example.com OR anno.example.com</li>
<li>Path is /path1</li>
</ul>
</li>
<li>rule-path2:<ul>
<li>Host is www.example.com</li>
<li>Path is /path2 OR /anno/path2</li>
</ul>
</li>
<li>rule-path3:<ul>
<li>Host is www.example.com</li>
<li>Path is /path3</li>
<li>Http header HeaderName is HeaderValue1 OR HeaderValue2</li>
</ul>
</li>
<li>rule-path4:<ul>
<li>Host is www.example.com</li>
<li>Path is /path4</li>
<li>Http request method is GET OR HEAD</li>
</ul>
</li>
<li>rule-path5:<ul>
<li>Host is www.example.com</li>
<li>Path is /path5</li>
<li>Query string is paramA:valueA1 OR paramA:valueA2</li>
</ul>
</li>
<li>rule-path6:<ul>
<li>Host is www.example.com</li>
<li>Path is /path6</li>
<li>Source IP is192.168.0.0/16 OR 172.16.0.0/16</li>
</ul>
</li>
<li>rule-path7:<ul>
<li>Host is www.example.com</li>
<li>Path is /path7</li>
<li>Http header HeaderName is HeaderValue</li>
<li>Query string is paramA:valueA</li>
<li>Query string is paramB:valueB</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ingress</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">alb.ingress.kubernetes.io/scheme</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">internet-facing</span>
<span class="w">    </span><span class="nt">alb.ingress.kubernetes.io/actions.rule-path1</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">{&quot;type&quot;:&quot;fixed-response&quot;,&quot;fixedResponseConfig&quot;:{&quot;contentType&quot;:&quot;text/plain&quot;,&quot;statusCode&quot;:&quot;200&quot;,&quot;messageBody&quot;:&quot;Host is www.example.com OR anno.example.com&quot;}}</span>
<span class="w">    </span><span class="nt">alb.ingress.kubernetes.io/conditions.rule-path1</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">[{&quot;field&quot;:&quot;host-header&quot;,&quot;hostHeaderConfig&quot;:{&quot;values&quot;:[&quot;anno.example.com&quot;]}}]</span>
<span class="w">    </span><span class="nt">alb.ingress.kubernetes.io/actions.rule-path2</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">{&quot;type&quot;:&quot;fixed-response&quot;,&quot;fixedResponseConfig&quot;:{&quot;contentType&quot;:&quot;text/plain&quot;,&quot;statusCode&quot;:&quot;200&quot;,&quot;messageBody&quot;:&quot;Path is /path2 OR /anno/path2&quot;}}</span>
<span class="w">    </span><span class="nt">alb.ingress.kubernetes.io/conditions.rule-path2</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">[{&quot;field&quot;:&quot;path-pattern&quot;,&quot;pathPatternConfig&quot;:{&quot;values&quot;:[&quot;/anno/path2&quot;]}}]</span>
<span class="w">    </span><span class="nt">alb.ingress.kubernetes.io/actions.rule-path3</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">{&quot;type&quot;:&quot;fixed-response&quot;,&quot;fixedResponseConfig&quot;:{&quot;contentType&quot;:&quot;text/plain&quot;,&quot;statusCode&quot;:&quot;200&quot;,&quot;messageBody&quot;:&quot;Http header HeaderName is HeaderValue1 OR HeaderValue2&quot;}}</span>
<span class="w">    </span><span class="nt">alb.ingress.kubernetes.io/conditions.rule-path3</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">[{&quot;field&quot;:&quot;http-header&quot;,&quot;httpHeaderConfig&quot;:{&quot;httpHeaderName&quot;: &quot;HeaderName&quot;, &quot;values&quot;:[&quot;HeaderValue1&quot;, &quot;HeaderValue2&quot;]}}]</span>
<span class="w">    </span><span class="nt">alb.ingress.kubernetes.io/actions.rule-path4</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">{&quot;type&quot;:&quot;fixed-response&quot;,&quot;fixedResponseConfig&quot;:{&quot;contentType&quot;:&quot;text/plain&quot;,&quot;statusCode&quot;:&quot;200&quot;,&quot;messageBody&quot;:&quot;Http request method is GET OR HEAD&quot;}}</span>
<span class="w">    </span><span class="nt">alb.ingress.kubernetes.io/conditions.rule-path4</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">[{&quot;field&quot;:&quot;http-request-method&quot;,&quot;httpRequestMethodConfig&quot;:{&quot;Values&quot;:[&quot;GET&quot;, &quot;HEAD&quot;]}}]</span>
<span class="w">    </span><span class="nt">alb.ingress.kubernetes.io/actions.rule-path5</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">{&quot;type&quot;:&quot;fixed-response&quot;,&quot;fixedResponseConfig&quot;:{&quot;contentType&quot;:&quot;text/plain&quot;,&quot;statusCode&quot;:&quot;200&quot;,&quot;messageBody&quot;:&quot;Query string is paramA:valueA1 OR paramA:valueA2&quot;}}</span>
<span class="w">    </span><span class="nt">alb.ingress.kubernetes.io/conditions.rule-path5</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">[{&quot;field&quot;:&quot;query-string&quot;,&quot;queryStringConfig&quot;:{&quot;values&quot;:[{&quot;key&quot;:&quot;paramA&quot;,&quot;value&quot;:&quot;valueA1&quot;},{&quot;key&quot;:&quot;paramA&quot;,&quot;value&quot;:&quot;valueA2&quot;}]}}]</span>
<span class="w">    </span><span class="nt">alb.ingress.kubernetes.io/actions.rule-path6</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">{&quot;type&quot;:&quot;fixed-response&quot;,&quot;fixedResponseConfig&quot;:{&quot;contentType&quot;:&quot;text/plain&quot;,&quot;statusCode&quot;:&quot;200&quot;,&quot;messageBody&quot;:&quot;Source IP is 192.168.0.0/16 OR 172.16.0.0/16&quot;}}</span>
<span class="w">    </span><span class="nt">alb.ingress.kubernetes.io/conditions.rule-path6</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">[{&quot;field&quot;:&quot;source-ip&quot;,&quot;sourceIpConfig&quot;:{&quot;values&quot;:[&quot;192.168.0.0/16&quot;, &quot;172.16.0.0/16&quot;]}}]</span>
<span class="w">    </span><span class="nt">alb.ingress.kubernetes.io/actions.rule-path7</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">{&quot;type&quot;:&quot;fixed-response&quot;,&quot;fixedResponseConfig&quot;:{&quot;contentType&quot;:&quot;text/plain&quot;,&quot;statusCode&quot;:&quot;200&quot;,&quot;messageBody&quot;:&quot;multiple conditions applies&quot;}}</span>
<span class="w">    </span><span class="nt">alb.ingress.kubernetes.io/conditions.rule-path7</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">[{&quot;field&quot;:&quot;http-header&quot;,&quot;httpHeaderConfig&quot;:{&quot;httpHeaderName&quot;: &quot;HeaderName&quot;, &quot;values&quot;:[&quot;HeaderValue&quot;]}},{&quot;field&quot;:&quot;query-string&quot;,&quot;queryStringConfig&quot;:{&quot;values&quot;:[{&quot;key&quot;:&quot;paramA&quot;,&quot;value&quot;:&quot;valueA&quot;}]}},{&quot;field&quot;:&quot;query-string&quot;,&quot;queryStringConfig&quot;:{&quot;values&quot;:[{&quot;key&quot;:&quot;paramB&quot;,&quot;value&quot;:&quot;valueB&quot;}]}}]</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ingressClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">alb</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">www.example.com</span>
<span class="w">      </span><span class="nt">http</span><span class="p">:</span>
<span class="w">        </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path1</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Exact</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rule-path1</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">use-annotation</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path2</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Exact</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rule-path2</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">use-annotation</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path3</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Exact</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rule-path3</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">use-annotation</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path4</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Exact</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rule-path4</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">use-annotation</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path5</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Exact</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rule-path5</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">use-annotation</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path6</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Exact</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rule-path6</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">use-annotation</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path7</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Exact</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rule-path7</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">use-annotation</span>
</code></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are using <code>alb.ingress.kubernetes.io/target-group-attributes</code> with <code>stickiness.enabled=true</code>, you should add <code>TargetGroupStickinessConfig</code> under <code>alb.ingress.kubernetes.io/actions.weighted-routing</code></p>
</div>
<div class="admonition example">
<p class="admonition-title">Example using target group stickiness config</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="w">    </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">    </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ingress</span>
<span class="w">    </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">        </span><span class="nt">alb.ingress.kubernetes.io/scheme</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">internet-facing</span>
<span class="w">        </span><span class="nt">alb.ingress.kubernetes.io/target-type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ip</span>
<span class="w">        </span><span class="nt">alb.ingress.kubernetes.io/target-group-attributes</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stickiness.enabled=true,stickiness.lb_cookie.duration_seconds=60</span>
<span class="w">        </span><span class="nt">alb.ingress.kubernetes.io/actions.weighted-routing</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="p p-Indicator">{</span>
<span class="w">            </span><span class="s">&quot;type&quot;</span><span class="p p-Indicator">:</span><span class="s">&quot;forward&quot;</span><span class="p p-Indicator">,</span>
<span class="w">            </span><span class="s">&quot;forwardConfig&quot;</span><span class="p p-Indicator">:{</span>
<span class="w">            </span><span class="s">&quot;targetGroups&quot;</span><span class="p p-Indicator">:[</span>
<span class="w">                </span><span class="p p-Indicator">{</span>
<span class="w">                </span><span class="s">&quot;serviceName&quot;</span><span class="p p-Indicator">:</span><span class="s">&quot;service-1&quot;</span><span class="p p-Indicator">,</span>
<span class="w">                </span><span class="s">&quot;servicePort&quot;</span><span class="p p-Indicator">:</span><span class="s">&quot;80&quot;</span><span class="p p-Indicator">,</span>
<span class="w">                </span><span class="s">&quot;weight&quot;</span><span class="p p-Indicator">:</span><span class="nv">50</span>
<span class="w">                </span><span class="p p-Indicator">},</span>
<span class="w">                </span><span class="p p-Indicator">{</span>
<span class="w">                </span><span class="s">&quot;serviceName&quot;</span><span class="p p-Indicator">:</span><span class="s">&quot;service-2&quot;</span><span class="p p-Indicator">,</span>
<span class="w">                </span><span class="s">&quot;servicePort&quot;</span><span class="p p-Indicator">:</span><span class="s">&quot;80&quot;</span><span class="p p-Indicator">,</span>
<span class="w">                </span><span class="s">&quot;weight&quot;</span><span class="p p-Indicator">:</span><span class="nv">50</span>
<span class="w">                </span><span class="p p-Indicator">}</span>
<span class="w">            </span><span class="p p-Indicator">],</span>
<span class="w">            </span><span class="s">&quot;TargetGroupStickinessConfig&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
<span class="w">                </span><span class="s">&quot;Enabled&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span>
<span class="w">                </span><span class="s">&quot;DurationSeconds&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">120</span>
<span class="w">            </span><span class="p p-Indicator">}</span>
<span class="w">            </span><span class="p p-Indicator">}</span>
<span class="w">        </span><span class="p p-Indicator">}</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">    </span><span class="nt">ingressClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">alb</span>
<span class="w">    </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">www.example.com</span>
<span class="w">        </span><span class="nt">http</span><span class="p">:</span>
<span class="w">            </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">                </span><span class="l l-Scalar l-Scalar-Plain">pathType</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">                </span><span class="l l-Scalar l-Scalar-Plain">backend</span><span class="p p-Indicator">:</span>
<span class="w">                </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">weighted-routing</span>
<span class="w">                    </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">use-annotation</span>
</code></pre></div>
</div>
<div class="admonition example">
<p class="admonition-title">Examples using <code>regexValues</code></p>
<p>HTTP header condition using regex values:</p>
<div class="highlight"><pre><span></span><code><span class="nt">alb.ingress.kubernetes.io/conditions.my-service</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">    </span><span class="no">[{ &quot;field&quot;: &quot;http-header&quot;, &quot;httpHeaderConfig&quot;: { &quot;httpHeaderName&quot;: &quot;User-Agent&quot;, &quot;regexValues&quot;: [ &quot;.+Chrome.+&quot; ] } }]</span>
</code></pre></div>
<p>Path condition using regex values:</p>
<div class="highlight"><pre><span></span><code><span class="nt">alb.ingress.kubernetes.io/conditions.my-service</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">    </span><span class="no">[{ &quot;field&quot;: &quot;path-pattern&quot;, &quot;pathPatternConfig&quot;: { &quot;regexValues&quot;: [ &quot;^/api/?(.*)$&quot; ] } }]</span>
</code></pre></div>
<p>Host header condition using regex values:</p>
<div class="highlight"><pre><span></span><code><span class="nt">alb.ingress.kubernetes.io/conditions.my-service</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">    </span><span class="no">[{ &quot;field&quot;: &quot;host-header&quot;, &quot;hostHeaderConfig&quot;: { &quot;regexValues&quot;: [ &quot;^(.+)\\.example\\.com&quot; ] } }]</span>
</code></pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Considerations when using <code>regexValues</code></p>
<p>ALB does not support mixing <code>values</code> (wildcard syntax) and <code>regexValues</code> (regex syntax) for the same condition type.</p>
<p>In particular, when using the AWS Load Balancer Controller:</p>
<ul>
<li>
<p>By default, additional <code>path-pattern</code> conditions <strong>must</strong> use <code>values</code>.</p>
<p>This is because the AWS Load Balancer Controller automatically adds <code>path-pattern</code> conditions using <code>values</code> according to your <a href="../spec/">Ingress specification</a>.</p>
<p>To configure additional <code>path-pattern</code> conditions using <code>regexValues</code>, configure the <a href="#use-regex-path-match"><code>alb.ingress.kubernetes.io/use-regex-path-match</code></a> annotation. When this annotation is set to <code>"true"</code>, the AWS Load Balancer Controller can add <code>path-pattern</code> conditions with <code>regexValues</code>.</p>
</li>
<li>
<p>If your <a href="../spec/">Ingress specification</a> includes a <code>host</code> rule, additional <code>host-header</code> conditions <strong>must</strong> use <code>values</code>.</p>
<p>To configure <code>host-header</code> conditions using <code>regexValues</code>, use the <code>alb.ingress.kubernetes.io/conditions.${conditions-name}</code> annotation instead of Ingress specification rules.</p>
</li>
</ul>
<p>In other words:</p>
<ul>
<li>When <a href="#use-regex-path-match"><code>alb.ingress.kubernetes.io/use-regex-path-match</code></a> is <code>"false"</code> (default value), for HTTP paths using <code>pathType: ImplementationSpecific</code>, additional <code>path-pattern</code> conditions can <strong>only</strong> use <code>values</code>.</li>
<li>When <a href="#use-regex-path-match"><code>alb.ingress.kubernetes.io/use-regex-path-match</code></a> is <code>"true"</code>, for HTTP paths using <code>pathType: ImplementationSpecific</code>, additional <code>path-pattern</code> conditions can <strong>only</strong> use <code>regexValues</code>.</li>
<li>If a ingress rule <code>host</code> is specified, additional <code>host-header</code> conditions can only use <code>values</code>.</li>
</ul>
</div>
</li>
<li>
<p><a name="use-regex-path-match"><code>alb.ingress.kubernetes.io/use-regex-path-match</code></a> Configure whether HTTP paths in your <a href="../spec/">Ingress specification</a> should be evaluated using regex.</p>
<ul>
<li>This configuration only applies to HTTP paths using <code>pathType: ImplementationSpecific</code>. HTTP paths using <code>pathType: Exact</code> or <code>pathType: Prefix</code> are not affected by this annotation.</li>
<li>A leading <code>/</code> must precede the regex. The leading <code>/</code> will be removed from the regex.</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Ingress rule path evaluated as regex</p>
<p>Annotation:</p>
<div class="highlight"><pre><span></span><code><span class="nt">alb.ingress.kubernetes.io/use-regex-path-match</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;true&quot;</span>
</code></pre></div>
<p>Ingress rule path:</p>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w">   </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/^/api/(.+)$&quot;</span>
<span class="w">    </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ImplementationSpecific</span>
<span class="w">    </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">        </span><span class="nt">service</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">service-2048</span>
<span class="w">        </span><span class="nt">port</span><span class="p">:</span>
<span class="w">            </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
</code></pre></div>
<p>With this configuration, the rule condition regex value will be <code>^/api/(.+)$</code> as the leading <code>/</code> is removed from the regex.</p>
</div>
</li>
</ul>
<h2 id="access-control">Access control<a class="headerlink" href="#access-control" title="Permanent link">&para;</a></h2>
<p>Access control for LoadBalancer can be controlled with following annotations:</p>
<ul>
<li>
<p><a name="scheme"><code>alb.ingress.kubernetes.io/scheme</code></a> specifies whether your LoadBalancer will be internet facing. See <a href="http://docs.aws.amazon.com/elasticloadbalancing/latest/userguide/how-elastic-load-balancing-works.html#load-balancer-scheme">Load balancer scheme</a> in the AWS documentation for more details.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/scheme: internal
</code></pre></div>
</div>
</li>
<li>
<p><a name="inbound-cidrs"><code>alb.ingress.kubernetes.io/inbound-cidrs</code></a> specifies the CIDRs that are allowed to access LoadBalancer.</p>
<div class="admonition note">
<p class="admonition-title">Merge Behavior</p>
<p><code>inbound-cidrs</code> is merged across all Ingresses in IngressGroup, but is exclusive per listen-port.</p>
<ul>
<li>the <code>inbound-cidrs</code> will only impact the ports defined for that Ingress.</li>
<li>if same listen-port is defined by multiple Ingress within IngressGroup, <code>inbound-cidrs</code> should only be defined on one of the Ingress.</li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Default</p>
<ul>
<li><code>0.0.0.0/0</code> will be used if the IPAddressType is "ipv4"</li>
<li><code>0.0.0.0/0</code> and <code>::/0</code> will be used if the IPAddressType is "dualstack"</li>
</ul>
</div>
<div class="admonition warning">
<p>this annotation will be ignored if <code>alb.ingress.kubernetes.io/security-groups</code> is specified.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/inbound-cidrs: 10.0.0.0/24
</code></pre></div>
</div>
</li>
<li>
<p><a name="security-group-prefix-lists"><code>alb.ingress.kubernetes.io/security-group-prefix-lists</code></a> specifies the managed prefix lists that are allowed to access LoadBalancer.</p>
<div class="admonition note">
<p class="admonition-title">Merge Behavior</p>
<p><code>security-group-prefix-lists</code> is merged across all Ingresses in IngressGroup, but is exclusive per listen-port.</p>
<ul>
<li>the <code>security-group-prefix-lists</code> will only impact the ports defined for that Ingress.</li>
<li>if same listen-port is defined by multiple Ingress within IngressGroup, <code>security-group-prefix-lists</code> should only be defined on one of the Ingress.</li>
</ul>
</div>
<div class="admonition warning">
<p>This annotation will be ignored if <code>alb.ingress.kubernetes.io/security-groups</code> is specified.</p>
</div>
<div class="admonition warning">
<p>If you'd like to use this annotation, make sure your security group rule quota is enough. If you'd like to know how the managed prefix list affects your quota, see the <a href="https://docs.aws.amazon.com/vpc/latest/userguide/working-with-aws-managed-prefix-lists.html#aws-managed-prefix-list-weights">reference</a> in the AWS documentation for more details.</p>
</div>
<div class="admonition tip">
<p>If you only use this annotation without <code>inbound-cidrs</code>, the controller managed security group would ignore the <code>inbound-cidrs</code> default settings.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/security-group-prefix-lists: pl-000000, pl-111111
</code></pre></div>
</div>
</li>
<li>
<p><a name="security-groups"><code>alb.ingress.kubernetes.io/security-groups</code></a> specifies the securityGroups you want to attach to LoadBalancer.</p>
<div class="admonition note">
<p>When this annotation is not present, the controller will automatically create one security group, the security group will be attached to the LoadBalancer and allow access from <a href="#inbound-cidrs"><code>inbound-cidrs</code></a> and <a href="#security-group-prefix-lists"><code>security-group-prefix-lists</code></a> to the <a href="#listen-ports"><code>listen-ports</code></a>.
Also, the securityGroups for Node/Pod will be modified to allow inbound traffic from this securityGroup.</p>
</div>
<div class="admonition note">
<p>If you specify this annotation, you need to configure the security groups on your Node/Pod to allow inbound traffic from the load balancer. You could also set the <a href="#manage-backend-security-group-rules"><code>manage-backend-security-group-rules</code></a> if you want the controller to manage the access rules.</p>
</div>
<div class="admonition tip">
<p>Both name or ID of securityGroups are supported. Name matches a <code>Name</code> tag, not the <code>groupName</code> attribute.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/security-groups: sg-xxxx, nameOfSg1, nameOfSg2
</code></pre></div>
</div>
</li>
<li>
<p><a name="manage-backend-security-group-rules"><code>alb.ingress.kubernetes.io/manage-backend-security-group-rules</code></a> specifies whether you want the controller to configure security group rules on Node/Pod for traffic access when you specify <a href="#security-groups"><code>security-groups</code></a>.</p>
<div class="admonition note">
<p>This annotation applies only in case you specify the security groups via <a href="#security-groups"><code>security-groups</code></a> annotation. If set to true, controller attaches an additional shared backend security group to your load balancer. This backend security group is used in the Node/Pod security group rules.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/manage-backend-security-group-rules: &quot;true&quot;
</code></pre></div>
</div>
</li>
</ul>
<h2 id="authentication">Authentication<a class="headerlink" href="#authentication" title="Permanent link">&para;</a></h2>
<p>ALB supports authentication with Cognito or OIDC. See <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/listener-authenticate-users.html">Authenticate Users Using an Application Load Balancer</a> for more details.</p>
<div class="admonition warning">
<p class="admonition-title">HTTPS only</p>
<p>Authentication is only supported for HTTPS listeners. See <a href="#tls">TLS</a> for configuring HTTPS listeners.</p>
</div>
<ul>
<li>
<p><a name="auth-type"><code>alb.ingress.kubernetes.io/auth-type</code></a> specifies the authentication type on targets.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/auth-type: cognito
</code></pre></div>
</div>
</li>
<li>
<p><a name="auth-idp-cognito"><code>alb.ingress.kubernetes.io/auth-idp-cognito</code></a> specifies the cognito idp configuration.</p>
<div class="admonition warning">
<p class="admonition-title">For Amazon Cognito Domain only</p>
<p>If you are using Amazon Cognito Domain, the <code>userPoolDomain</code> should be set to the domain prefix(my-domain) instead of full domain(https://my-domain.auth.us-west-2.amazoncognito.com)</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/auth-idp-cognito: &#39;{&quot;userPoolARN&quot;:&quot;arn:aws:cognito-idp:us-west-2:xxx:userpool/xxx&quot;,&quot;userPoolClientID&quot;:&quot;my-clientID&quot;,&quot;userPoolDomain&quot;:&quot;my-domain&quot;}&#39;
</code></pre></div>
</div>
</li>
<li>
<p><a name="auth-idp-oidc"><code>alb.ingress.kubernetes.io/auth-idp-oidc</code></a> specifies the oidc idp configuration.</p>
<div class="admonition tip">
<p>You need to create a <a href="https://kubernetes.io/docs/concepts/configuration/secret/">secret</a> within the same namespace as Ingress to hold your OIDC clientID and clientSecret. The format of secret is as below:
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Secret</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">testcase</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-k8s-secret</span>
<span class="nt">data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">clientID</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">base64 of your plain text clientId</span>
<span class="w">  </span><span class="nt">clientSecret</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">base64 of your plain text clientSecret</span>
</code></pre></div></p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/auth-idp-oidc: &#39;{&quot;issuer&quot;:&quot;https://example.com&quot;,&quot;authorizationEndpoint&quot;:&quot;https://authorization.example.com&quot;,&quot;tokenEndpoint&quot;:&quot;https://token.example.com&quot;,&quot;userInfoEndpoint&quot;:&quot;https://userinfo.example.com&quot;,&quot;secretName&quot;:&quot;my-k8s-secret&quot;}&#39;
</code></pre></div>
</div>
</li>
<li>
<p><a name="auth-on-unauthenticated-request"><code>alb.ingress.kubernetes.io/auth-on-unauthenticated-request</code></a> specifies the behavior if the user is not authenticated.</p>
<div class="admonition info">
<p class="admonition-title">options:</p>
<ul>
<li><strong>authenticate</strong>: try to authenticate with configured IDP.</li>
<li><strong>deny</strong>: return an HTTP 401 Unauthorized error.</li>
<li><strong>allow</strong>: allow the request to be forwarded to the target.</li>
</ul>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/auth-on-unauthenticated-request: authenticate
</code></pre></div>
</div>
</li>
<li>
<p><a name="auth-scope"><code>alb.ingress.kubernetes.io/auth-scope</code></a> specifies the set of user claims to be requested from the IDP(cognito or oidc), in a space-separated list.</p>
<div class="admonition info">
<p class="admonition-title">options:</p>
<ul>
<li><strong>phone</strong></li>
<li><strong>email</strong></li>
<li><strong>profile</strong></li>
<li><strong>openid</strong></li>
<li><strong>aws.cognito.signin.user.admin</strong></li>
</ul>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/auth-scope: &#39;email openid&#39;
</code></pre></div>
</div>
</li>
<li>
<p><a name="auth-session-cookie"><code>alb.ingress.kubernetes.io/auth-session-cookie</code></a> specifies the name of the cookie used to maintain session information</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/auth-session-cookie: custom-cookie
</code></pre></div>
</div>
</li>
<li>
<p><a name="auth-session-timeout"><code>alb.ingress.kubernetes.io/auth-session-timeout</code></a> specifies the maximum duration of the authentication session, in seconds</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/auth-session-timeout: &#39;86400&#39;
</code></pre></div>
</div>
</li>
</ul>
<h2 id="token-validation">Token Validation<a class="headerlink" href="#token-validation" title="Permanent link">&para;</a></h2>
<p>ALB supports validating JSON Web Tokens (JWTs) for secure service-to-service communication. The <code>exp</code> and <code>iss</code> claims are always validated by default. If present, the <code>nbf</code> and <code>iat</code> claims will also be automatically validated. JWT validation can be controlled with the following annotation:</p>
<div class="admonition warning">
<p class="admonition-title">HTTPS only</p>
<p>JWT validation is only supported for HTTPS listeners. See <a href="#tls">TLS</a> for configuring HTTPS listeners.</p>
</div>
<ul>
<li>
<p><a name="jwt-validation"><code>alb.ingress.kubernetes.io/jwt-validation</code></a> specifies the configuration for JWT validation. This includes the JSON Web Key Set (JWKS) endpoint and issuer, along with any additional claims to validate. For each additional claim added, the name of the claim, the format of the values in the JWT, and the values of the claim should all be specified.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/jwt-validation: &#39;{&quot;jwksEndpoint&quot;:&quot;https://example-endpoint.com&quot;,&quot;issuer&quot;:&quot;https://example-issuer.com&quot;,&quot;additionalClaims&quot;:[{&quot;name&quot;:&quot;admin&quot;,&quot;format&quot;:&quot;single-string&quot;,&quot;values&quot;:[&quot;true&quot;]},{&quot;name&quot;:&quot;ver&quot;,&quot;format&quot;:&quot;string-array&quot;,&quot;values&quot;:[&quot;6&quot;,&quot;19&quot;]},{&quot;name&quot;:&quot;scope&quot;,&quot;format&quot;:&quot;space-separated-values&quot;,&quot;values&quot;:[&quot;read:api&quot;,&quot;write&quot;,&quot;email&quot;]}]}&#39;
</code></pre></div>
</div>
</li>
</ul>
<h2 id="health-check">Health Check<a class="headerlink" href="#health-check" title="Permanent link">&para;</a></h2>
<p>Health check on target groups can be controlled with following annotations:</p>
<ul>
<li>
<p><a name="healthcheck-protocol"><code>alb.ingress.kubernetes.io/healthcheck-protocol</code></a> specifies the protocol used when performing health check on targets.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/healthcheck-protocol: HTTPS
</code></pre></div>
</div>
</li>
<li>
<p><a name="healthcheck-port"><code>alb.ingress.kubernetes.io/healthcheck-port</code></a> specifies the port used when performing health check on targets.</p>
<div class="admonition warning">
<p>When using <code>target-type: instance</code> with a service of type "NodePort", the healthcheck port can be set to <code>traffic-port</code> to automatically point to the correct port.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>set the healthcheck port to the traffic port
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/healthcheck-port: traffic-port
</code></pre></div></li>
<li>set the healthcheck port to the NodePort(when target-type=instance) or TargetPort(when target-type=ip) of a named port
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/healthcheck-port: my-port
</code></pre></div></li>
<li>set the healthcheck port to 80/tcp
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/healthcheck-port: &#39;80&#39;
</code></pre></div></li>
</ul>
</div>
</li>
<li>
<p><a name="healthcheck-path"><code>alb.ingress.kubernetes.io/healthcheck-path</code></a> specifies the HTTP path when performing health check on targets.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>HTTP
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/healthcheck-path: /ping
</code></pre></div></li>
<li>GRPC
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/healthcheck-path: /package.service/method
</code></pre></div></li>
</ul>
</div>
</li>
<li>
<p><a name="healthcheck-interval-seconds"><code>alb.ingress.kubernetes.io/healthcheck-interval-seconds</code></a> specifies the interval(in seconds) between health check of an individual target.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/healthcheck-interval-seconds: &#39;10&#39;
</code></pre></div>
</div>
</li>
<li>
<p><a name="healthcheck-timeout-seconds"><code>alb.ingress.kubernetes.io/healthcheck-timeout-seconds</code></a> specifies the timeout(in seconds) during which no response from a target means a failed health check</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/healthcheck-timeout-seconds: &#39;8&#39;
</code></pre></div>
</div>
</li>
<li>
<p><a name="success-codes"><code>alb.ingress.kubernetes.io/success-codes</code></a> specifies the HTTP or gRPC status code that should be expected when doing health checks against the specified health check path.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>use single value
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/success-codes: &#39;200&#39;
</code></pre></div></li>
<li>use multiple values
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/success-codes: 200,201
</code></pre></div></li>
<li>use range of value
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/success-codes: 200-300
</code></pre></div></li>
<li>use gRPC single value
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/success-codes: &#39;0&#39;
</code></pre></div></li>
<li>use gRPC multiple value
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/success-codes: 0,1
</code></pre></div></li>
<li>use gRPC range of value
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/success-codes: 0-5
</code></pre></div></li>
</ul>
</div>
</li>
<li>
<p><a name="healthy-threshold-count"><code>alb.ingress.kubernetes.io/healthy-threshold-count</code></a> specifies the consecutive health checks successes required before considering an unhealthy target healthy.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/healthy-threshold-count: &#39;2&#39;
</code></pre></div>
</div>
</li>
<li>
<p><a name="unhealthy-threshold-count"><code>alb.ingress.kubernetes.io/unhealthy-threshold-count</code></a> specifies the consecutive health check failures required before considering a target unhealthy.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p><code>alb.ingress.kubernetes.io/unhealthy-threshold-count: '2'</code></p>
</div>
</li>
</ul>
<h2 id="tls">TLS<a class="headerlink" href="#tls" title="Permanent link">&para;</a></h2>
<p>TLS support can be controlled with the following annotations:</p>
<ul>
<li>
<p><a name="certificate-arn"><code>alb.ingress.kubernetes.io/certificate-arn</code></a> specifies the ARN of one or more certificate managed by <a href="https://aws.amazon.com/certificate-manager">AWS Certificate Manager</a></p>
<div class="admonition tip">
<p>The first certificate in the list will be added as the default certificate.
The remaining certificates will be added to the optional SNI certificate list.
If the same certificate as the default certificate is also listed again (either explicitly in the list or via annotations from other IngressGroup members), it will still be added to the SNI list as well.
See <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/create-https-listener.html#https-listener-certificates">SSL Certificates</a> for more details.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Certificate Discovery</p>
<p>TLS certificates for ALB Listeners can be automatically discovered with hostnames from Ingress resources. See <a href="../cert_discovery/">Certificate Discovery</a> for instructions.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>single certificate
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/certificate-arn: arn:aws:acm:us-west-2:xxxxx:certificate/xxxxxxx
</code></pre></div></li>
<li>multiple certificates
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/certificate-arn: arn:aws:acm:us-west-2:xxxxx:certificate/cert1,arn:aws:acm:us-west-2:xxxxx:certificate/cert2,arn:aws:acm:us-west-2:xxxxx:certificate/cert3
</code></pre></div></li>
</ul>
</div>
</li>
<li>
<p><a name="ssl-policy"><code>alb.ingress.kubernetes.io/ssl-policy</code></a> specifies the <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/describe-ssl-policies.html">Security Policy</a> that should be assigned to the ALB, allowing you to control the protocol and ciphers.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/ssl-policy: ELBSecurityPolicy-TLS-1-1-2017-01
</code></pre></div>
</div>
</li>
<li>
<p><a name="mutual-authentication"><code>alb.ingress.kubernetes.io/mutual-authentication</code></a>  specifies the mutual authentication configuration that should be assigned to the Application Load Balancer secure listener ports. See <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/mutual-authentication.html">Mutual authentication with TLS</a> in the AWS documentation for more details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>This annotation is not applicable for Outposts, Local Zones or Wavelength zones.</li>
<li>"Configuration Options"<ul>
<li><code>port: listen port</code></li>
<li>Must be an HTTPS port specified by <a href="#listen-ports">listen-ports</a>.</li>
<li><code>mode: "off" (default) | "passthrough" | "verify"</code></li>
<li><code>verify</code> mode requires an existing trust store resource.</li>
<li>See <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/mutual-authentication.html#create-trust-store">Create a trust store</a> in the AWS documentation for more details.</li>
<li><code>trustStore: ARN (arn:aws:elasticloadbalancing:trustStoreArn) | Name (my-trust-store)</code></li>
<li>Both ARN and Name of trustStore are supported values.</li>
<li><code>trustStore</code> is required when mode is <code>verify</code>.</li>
<li><code>ignoreClientCertificateExpiry : true | false (default)</code></li>
<li><code>advertiseTrustStoreCaNames : "on" | "off" (default)</code></li>
</ul>
</li>
<li>Once the Mutual Authentication is set, to turn it off, you will have to explicitly pass in this annotation with <code>mode : "off"</code>.</li>
</ul>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li><a href="#listen-ports">listen-ports</a> specifies four HTTPS ports: <code>80, 443, 8080, 8443</code></li>
<li>listener <code>HTTPS:80</code> will be set to <code>passthrough</code> mode</li>
<li>listener <code>HTTPS:443</code> will be set to <code>verify</code> mode, associated with trust store arn <code>arn:aws:elasticloadbalancing:trustStoreArn</code> and have <code>ignoreClientCertificateExpiry</code> set to <code>true</code></li>
<li>listeners <code>HTTPS:8080</code> and <code>HTTPS:8443</code> remain in the default mode <code>off</code>.
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/listen-ports: &#39;[{&quot;HTTPS&quot;: 80}, {&quot;HTTPS&quot;: 443}, {&quot;HTTPS&quot;: 8080}, {&quot;HTTPS&quot;: 8443}]&#39;
alb.ingress.kubernetes.io/mutual-authentication: &#39;[{&quot;port&quot;: 80, &quot;mode&quot;: &quot;passthrough&quot;},
                                                   {&quot;port&quot;: 443, &quot;mode&quot;: &quot;verify&quot;, &quot;trustStore&quot;: &quot;arn:aws:elasticloadbalancing:trustStoreArn&quot;, &quot;ignoreClientCertificateExpiry&quot; : true}]&#39;
</code></pre></div></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To avoid conflict errors in IngressGroup, this annotation should only be specified on a single Ingress within IngressGroup or specified with same value across all Ingresses within IngressGroup.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Trust stores limit per Application Load Balancer</p>
<p>A maximum of two different trust stores can be associated among listeners on the same ingress. See <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-limits.html">Quotas for your Application Load Balancers</a> in the AWS documentation for more details.</p>
</div>
</li>
</ul>
<h2 id="custom-attributes">Custom attributes<a class="headerlink" href="#custom-attributes" title="Permanent link">&para;</a></h2>
<p>Custom attributes to LoadBalancers and TargetGroups can be controlled with following annotations:</p>
<ul>
<li>
<p><a name="load-balancer-attributes"><code>alb.ingress.kubernetes.io/load-balancer-attributes</code></a> specifies <a href="http://docs.aws.amazon.com/elasticloadbalancing/latest/APIReference/API_LoadBalancerAttribute.html">Load Balancer Attributes</a> that should be applied to the ALB.</p>
<div class="admonition warning">
<p>Only attributes defined in the annotation will be updated. To unset any AWS defaults(e.g. Disabling access logs after having them enabled once), the values need to be explicitly set to the original values(<code>access_logs.s3.enabled=false</code>) and omitting them is not sufficient.</p>
</div>
<div class="admonition note">
<ul>
<li>If <code>deletion_protection.enabled=true</code> is in annotation, the controller will not be able to delete the ALB during reconciliation. Once the attribute gets edited to <code>deletion_protection.enabled=false</code> during reconciliation, the deployer will force delete the resource.</li>
<li>Please note, if the deletion protection is not enabled via annotation (e.g. via AWS console), the controller still deletes the underlying resource.</li>
</ul>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>enable access log to s3
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/load-balancer-attributes: access_logs.s3.enabled=true,access_logs.s3.bucket=my-access-log-bucket,access_logs.s3.prefix=my-app
</code></pre></div></li>
<li>enable deletion protection
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/load-balancer-attributes: deletion_protection.enabled=true
</code></pre></div></li>
<li>enable invalid header fields removal
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/load-balancer-attributes: routing.http.drop_invalid_header_fields.enabled=true
</code></pre></div></li>
<li>enable http2 support
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/load-balancer-attributes: routing.http2.enabled=true
</code></pre></div></li>
<li>set idle_timeout delay to 600 seconds
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/load-balancer-attributes: idle_timeout.timeout_seconds=600
</code></pre></div></li>
<li>set client_keep_alive to 3600 seconds
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/load-balancer-attributes: client_keep_alive.seconds=3600
</code></pre></div></li>
<li>enable <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-connection-logs.html">connection logs</a>
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/load-balancer-attributes: connection_logs.s3.enabled=true,connection_logs.s3.bucket=my-connection-log-bucket,connection_logs.s3.prefix=my-app
</code></pre></div></li>
</ul>
</div>
<ul>
<li><a name="target-group-attributes"><code>alb.ingress.kubernetes.io/target-group-attributes</code></a> specifies <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-target-groups.html#target-group-attributes">Target Group Attributes</a> which should be applied to Target Groups.</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>set the slow start duration to 30 seconds (available range is 30-900 seconds)
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/target-group-attributes: slow_start.duration_seconds=30
</code></pre></div></li>
<li>set the deregistration delay to 30 seconds (available range is 0-3600 seconds)
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/target-group-attributes: deregistration_delay.timeout_seconds=30
</code></pre></div></li>
<li>enable sticky sessions (requires <code>alb.ingress.kubernetes.io/target-type</code> be set to <code>ip</code>)
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/target-group-attributes: stickiness.enabled=true,stickiness.lb_cookie.duration_seconds=60
alb.ingress.kubernetes.io/target-type: ip
</code></pre></div></li>
<li>set load balancing algorithm to least outstanding requests
            <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/target-group-attributes: load_balancing.algorithm.type=least_outstanding_requests
</code></pre></div></li>
<li>enable Automated Target Weights(ATW) on HTTP/HTTPS target groups to increase application availability. Set your load balancing algorithm to weighted random and turn on anomaly mitigation (recommended)
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/target-group-attributes: load_balancing.algorithm.type=weighted_random,load_balancing.algorithm.anomaly_mitigation=on
</code></pre></div></li>
</ul>
</div>
</li>
<li>
<p><a name="multi-cluster-target-group"><code>alb.ingress.kubernetes.io/multi-cluster-target-group</code></a> Allows you to share the created Target Group ARN with other Load Balancer Controller managed clusters.</p>
<div class="admonition warning"></div>
<p>This feature does not offer any Deletion Protection. Deleting the resource will still delete the Target Group. If you need to support
Target Groups shared with multiple clusters, it's recommended to use an out-of-band Target Group that is not managed by a Load Balancer Controller.</p>
<div class="admonition note"></div>
<ul>
<li>It is not recommended to change this value frequently, if ever. The recommended way to set this value is on creation of the service or ingress.</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Example</p>
</div>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/multi-cluster-target-group: &quot;true&quot;
</code></pre></div>
</li>
<li>
<p><a name="listener-attributes"><code>alb.ingress.kubernetes.io/listener-attributes.${Protocol}-${Port}</code></a> specifies Listener Attributes which should be applied to listener.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>Server header enablement attribute
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/listener-attributes.HTTP-80: routing.http.response.server.enabled=true
</code></pre></div></li>
<li>Add Access-Control-Allow-Headers header value (with comma)
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/listener-attributes.HTTPS-443: &quot;routing.http.response.access_control_allow_headers.header_value=exampleValue\\,anotherExampleValue&quot;
</code></pre></div>
    or
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/listener-attributes.HTTPS-443: routing.http.response.access_control_allow_headers.header_value=exampleValue\,anotherExampleValue
</code></pre></div>
    both result Access-Control-Allow-Headers header value: exampleValue,anotherExampleValue</li>
</ul>
</div>
</li>
</ul>
<h2 id="resource-tags">Resource Tags<a class="headerlink" href="#resource-tags" title="Permanent link">&para;</a></h2>
<p>The AWS Load Balancer Controller automatically applies following tags to the AWS resources (ALB/TargetGroups/SecurityGroups/Listener/ListenerRule) it creates:</p>
<ul>
<li><code>elbv2.k8s.aws/cluster: ${clusterName}</code></li>
<li><code>ingress.k8s.aws/stack: ${stackID}</code></li>
<li><code>ingress.k8s.aws/resource: ${resourceID}</code></li>
</ul>
<p>In addition, you can use annotations to specify additional tags</p>
<ul>
<li>
<p><a name="tags"><code>alb.ingress.kubernetes.io/tags</code></a> specifies additional tags that will be applied to AWS resources created.
  In case of target group, the controller will merge the tags from the ingress and the backend service giving precedence
  to the values specified on the service when there is conflict.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/tags: Environment=dev,Team=test
</code></pre></div>
</div>
</li>
</ul>
<h2 id="capacity-unit-reservation">Capacity Unit Reservation<a class="headerlink" href="#capacity-unit-reservation" title="Permanent link">&para;</a></h2>
<p>Load balancer capacity unit reservation can be configured via following annotations:</p>
<ul>
<li>
<p><a name="load-balancer-capacity-reservation"><code>alb.ingress.kubernetes.io/minimum-load-balancer-capacity</code></a> specifies the
  <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/capacity-unit-reservation.html">Capacity Unit Reservation</a> to be configured.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>set the capacity unit reservation to 1000
  <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/minimum-load-balancer-capacity: CapacityUnits=1000
</code></pre></div></li>
<li>reset the capacity unit reservation
  <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/minimum-load-balancer-capacity: CapacityUnits=0
</code></pre></div></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Notes</p>
<ul>
<li>If you specify this annotation, but remove it later, the capacity unit reservation is not reset. You need to reset the capacity by setting the capacity units to zero as show in the example above.</li>
<li>If users do not want the controller to manage the capacity unit reservation on load balancer, they can disable the feature by setting controller command line feature gate flag <code>--feature-gates=LBCapacityReservation=true</code></li>
</ul>
</div>
</li>
</ul>
<h2 id="addons">Addons<a class="headerlink" href="#addons" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p><a name="waf-acl-id"><code>alb.ingress.kubernetes.io/waf-acl-id</code></a> specifies the identifier for the Amazon WAF Classic web ACL.</p>
<div class="admonition warning">
<p>Only Regional WAF Classic is supported.</p>
</div>
<div class="admonition note">
<p>When this annotation is absent or empty, the controller will keep LoadBalancer WAF Classic settings unchanged.
To disable WAF Classic, explicitly set the annotation value to 'none'.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>enable WAF Classic
    <code>alb.ingress.kubernetes.io/waf-acl-id: 499e8b99-6671-4614-a86d-adb1810b7fbe</code></li>
<li>disable WAF Classic
    <code>alb.ingress.kubernetes.io/waf-acl-id: none</code></li>
</ul>
</div>
</li>
<li>
<p><a name="wafv2-acl-arn"><code>alb.ingress.kubernetes.io/wafv2-acl-arn</code></a> specifies ARN for the Amazon WAFv2 web ACL.</p>
<div class="admonition warning">
<p>Only Regional WAFv2 is supported.</p>
</div>
<div class="admonition note">
<p>When this annotation is absent or empty, the controller will keep LoadBalancer WAFv2 settings unchanged.
To disable WAFv2, explicitly set the annotation value to 'none'.</p>
</div>
<div class="admonition tip">
<p>To get the WAFv2 Web ACL ARN from the Console, click the gear icon in the upper right and enable the ARN column.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>enable WAFv2
    <code>alb.ingress.kubernetes.io/wafv2-acl-arn: arn:aws:wafv2:us-west-2:xxxxx:regional/webacl/xxxxxxx/3ab78708-85b0-49d3-b4e1-7a9615a6613b</code></li>
<li>disable WAFV2
    <code>alb.ingress.kubernetes.io/wafv2-acl-arn: none</code></li>
</ul>
</div>
</li>
<li>
<p><a name="wafv2-acl-name"><code>alb.ingress.kubernetes.io/wafv2-acl-name</code></a> specifies Name of the Amazon WAFv2 web ACL.</p>
<div class="admonition note">
<p>The controller role must allow access to <code>wafv2:ListWebACLs</code> </p>
</div>
<div class="admonition warning">
<p>Only Regional WAFv2 is supported.</p>
</div>
<div class="admonition note">
<p>When this annotation is absent or empty, the controller will keep LoadBalancer WAFv2 settings unchanged.
To disable WAFv2, explicitly set the annotation value to 'none'.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>enable WAFv2
    <code>alb.ingress.kubernetes.io/wafv2-acl-name: web-acl-name-1</code></li>
<li>disable WAFV2
    <code>alb.ingress.kubernetes.io/wafv2-acl-name: none</code></li>
</ul>
</div>
</li>
<li>
<p><a name="shield-advanced-protection"><code>alb.ingress.kubernetes.io/shield-advanced-protection</code></a> turns on / off the AWS Shield Advanced protection for the load balancer.</p>
<div class="admonition note">
<p>When this annotation is absent, the controller will keep LoadBalancer shield protection settings unchanged.
To disable shield protection, explicitly set the annotation value to 'false'.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>enable shield protection
    <code>alb.ingress.kubernetes.io/shield-advanced-protection: 'true'</code></li>
<li>disable shield protection
    <code>alb.ingress.kubernetes.io/shield-advanced-protection: 'false'</code></li>
</ul>
</div>
</li>
</ul>
<h2 id="enable-frontend-nlb">Enable frontend NLB<a class="headerlink" href="#enable-frontend-nlb" title="Permanent link">&para;</a></h2>
<p>When this option is set to true, the controller will automatically provision a Network Load Balancer and register the Application Load Balancer as its target. Additional annotations are available to customize the NLB configurations, including options for scheme, security groups, subnets, and health check. The ingress resource will have two status entries, one for the NLB DNS and one for the ALB DNS. This allows users to combine the benefits of NLB and ALB into a single solution, leveraging NLB features like static IP address and PrivateLink, while retaining the rich routing capabilities of ALB.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul>
<li>If you need to change the ALB <a href="#scheme">scheme</a>, make sure to disable this feature first. Changing the scheme will create a new ALB, which could interfere with the current configuration.</li>
<li>If you create ingress and enable the feature at once, provisioning the NLB and registering the ALB as target can take up to 3-4 mins to complete.</li>
</ul>
</div>
<ul>
<li>
<p><a name="enable-frontend-nlb"><code>alb.ingress.kubernetes.io/enable-frontend-nlb</code></a> enables frontend Network Load Balancer functionality.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>Enable frontend nlb
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/enable-frontend-nlb: &quot;true&quot;
</code></pre></div></li>
</ul>
</div>
</li>
<li>
<p><a name="frontend-nlb-scheme"><code>alb.ingress.kubernetes.io/frontend-nlb-scheme</code></a> specifies the scheme for the Network Load Balancer.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>Set NLB scheme to internet-facing
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/frontend-nlb-scheme: internet-facing
</code></pre></div></li>
</ul>
</div>
</li>
<li>
<p><a name="frontend-nlb-subnets"><code>alb.ingress.kubernetes.io/frontend-nlb-subnets</code></a> specifies the subnets for the Network Load Balancer.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>Specify subnets for NLB
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/frontend-nlb-subnets: subnet-xxxx1,subnet-xxxx2
</code></pre></div></li>
</ul>
</div>
</li>
<li>
<p><a name="frontend-nlb-security-groups"><code>alb.ingress.kubernetes.io/frontend-nlb-security-groups</code></a> specifies the security groups for the Network Load Balancer.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>Specify security groups for NLB
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/frontend-nlb-security-groups: sg-xxxx1,sg-xxxx2
</code></pre></div></li>
</ul>
</div>
</li>
<li>
<p><a name="frontend-nlb-listener-port-mapping"><code>alb.ingress.kubernetes.io/frontend-nlb-listener-port-mapping</code></a> specifies the port mapping configuration for the Network Load Balancer listeners.</p>
<div class="admonition note">
<p class="admonition-title">Default</p>
<ul>
<li>The port defaults to match the ALB listener port, based on whether <code>alb.ingress.kubernetes.io/listen-ports</code>(#listen-ports) is specified.</li>
</ul>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>Forward TCP traffic from NLB:80 to ALB:443
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/frontend-nlb-listener-port-mapping: 80=443
</code></pre></div></li>
</ul>
</div>
</li>
<li>
<p><a name="frontend-nlb-healthcheck-port"><code>alb.ingress.kubernetes.io/frontend-nlb-healthcheck-port</code></a> specifies the port used for health checks.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>Set health check port
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/frontend-nlb-healthcheck-port: traffic-port
</code></pre></div></li>
</ul>
</div>
</li>
<li>
<p><a name="frontend-nlb-healthcheck-protocol"><code>alb.ingress.kubernetes.io/frontend-nlb-healthcheck-protocol</code></a> specifies the protocol used for health checks.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>Set health check protocol
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/frontend-nlb-healthcheck-protocol: HTTP
</code></pre></div></li>
</ul>
</div>
</li>
<li>
<p><a name="frontend-nlb-healthcheck-path"><code>alb.ingress.kubernetes.io/frontend-nlb-healthcheck-path</code></a> specifies the destination path for health checks.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>Set health check path
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/frontend-nlb-healthcheck-path: /health
</code></pre></div></li>
</ul>
</div>
</li>
<li>
<p><a name="frontend-nlb-healthcheck-interval-seconds"><code>alb.ingress.kubernetes.io/frontend-nlb-healthcheck-interval-seconds</code></a> specifies the interval between consecutive health checks.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>Set health check interval
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/frontend-nlb-healthcheck-interval-seconds: &#39;15&#39;
</code></pre></div></li>
</ul>
</div>
</li>
<li>
<p><a name="frontend-nlb-healthcheck-timeout-seconds"><code>alb.ingress.kubernetes.io/frontend-nlb-healthcheck-timeout-seconds</code></a> specifies the target group health check timeout.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>Set health check timeout
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/frontend-nlb-healthcheck-timeout-seconds: &#39;5&#39;
</code></pre></div></li>
</ul>
</div>
</li>
<li>
<p><a name="frontend-nlb-healthcheck-healthy-threshold-count"><code>alb.ingress.kubernetes.io/frontend-nlb-healthcheck-healthy-threshold-count</code></a> specifies the consecutive health check successes required before a target is considered healthy.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>Set healthy threshold count
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/frontend-nlb-healthcheck-healthy-threshold-count: &#39;3&#39;
</code></pre></div></li>
</ul>
</div>
</li>
<li>
<p><a name="frontend-nlb-healthcheck-unhealthy-threshold-count"><code>alb.ingress.kubernetes.io/frontend-nlb-healthcheck-unhealthy-threshold-count</code></a> specifies the consecutive health check failures before a target gets marked unhealthy.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>Set unhealthy threshold count
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/frontend-nlb-healthcheck-unhealthy-threshold-count: &#39;3&#39;
</code></pre></div></li>
</ul>
</div>
</li>
<li>
<p><a name="frontend-nlb-healthcheck-success-codes"><code>alb.ingress.kubernetes.io/frontend-nlb-healthcheck-success-codes</code></a> specifies the HTTP codes that indicate a successful health check.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>Set success codes for health check
    <div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/frontend-nlb-healthcheck-success-codes: &#39;200&#39;
</code></pre></div></li>
</ul>
</div>
</li>
<li>
<p><a name="frontend-nlb-tags"><code>alb.ingress.kubernetes.io/frontend-nlb-tags</code></a> specifies additional tags to be applied to the frontend NLB. If not specified, the tags from ALB (specified via <code>alb.ingress.kubernetes.io/tags</code>) will be propagated to the NLB.</p>
<div class="admonition note">
<p class="admonition-title">Merge Behavior</p>
<p><code>frontend-nlb-tags</code> is exclusive across all Ingresses in IngressGroup.
If specified on multiple Ingresses within IngressGroup, the values must match.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/frontend-nlb-tags: Environment=prod,Team=platform
</code></pre></div>
</div>
</li>
<li>
<p><a name="frontend-nlb-eip-allocations"><code>alb.ingress.kubernetes.io/frontend-nlb-eip-allocations</code></a> specifies a list of <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/elastic-ip-addresses-eip.html">elastic IP address</a> configuration for an internet-facing NLB.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>This configuration is optional, and you can use it to assign static IP addresses to your NLB</li>
<li>If you include the subnets <a href="#frontend-nlb-subnets">annotation</a> it must have the same number of subnets as this annotation has EIPs.</li>
<li>NLB must be internet-facing</li>
</ul>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>alb.ingress.kubernetes.io/frontend-nlb-eip-allocations: eipalloc-xyz, eipalloc-zzz
</code></pre></div>
</div>
</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
    
      <script src="../../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
        <script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js"></script>
      
    
    <script src="../../../assets/javascripts/version-select.js"></script>

  </body>
</html>